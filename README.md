# Node.js Authentication API

Это проект на Node.js, который реализует систему аутентификации с использованием JWT (JSON Web Tokens). В проекте используются следующие технологии и библиотеки:

- **Node.js**
- **Express.js** для обработки HTTP-запросов
- **Mongoose** для работы с MongoDB
- **bcryptjs** для хеширования паролей
- **jsonwebtoken** для генерации и проверки JWT
- **express-validator** для валидации данных

## Описание

Этот API предоставляет базовые маршруты для регистрации и логина пользователей. Он использует JWT для авторизации и проверки прав доступа. В проекте предусмотрены разные роли для пользователей, и доступ к определенным маршрутам ограничен в зависимости от роли пользователя.

## Структура проекта

├── controllers/ # Логика для обработки запросов
│ └── authController.js
├── models/ # Модели данных (MongoDB)
│ ├── User.js
│ └── Role.js
├── middleware/ # Промежуточное ПО для проверки авторизации и ролей
│ ├── authMiddleware.js
│ └── roleMiddleware.js
├── routes/ # Маршруты API
│ └── authRoute.js
├── config.js # Конфигурации (подключение к базе данных, секреты)
└── server.js # Главный файл для запуска сервера

bash
Копировать
Редактировать

## Установка

1. Клонируйте репозиторий:

```bash
git clone https://github.com/your-username/your-repository.git
Перейдите в каталог проекта:

bash
Копировать
Редактировать
cd your-repository
Установите зависимости:

bash
Копировать
Редактировать
npm install
Настройте переменные окружения:

Создайте файл .env в корне проекта и добавьте необходимые значения:

ini
Копировать
Редактировать
MONGO_URI=mongodb://localhost:27017/your-database
SECRET_KEY=your-secret-key
PORT=5000
Запуск
Для запуска сервера используйте команду:

bash
Копировать
Редактировать
npm start
Сервер будет доступен по адресу http://localhost:5000.

Маршруты API
Регистрация пользователя
POST /auth/reg

Параметры:

username (строка): имя пользователя

password (строка): пароль пользователя (минимум 4, максимум 10 символов)

Пример запроса:

json
Копировать
Редактировать
{
  "username": "john_doe",
  "password": "123456"
}
Ответ:

json
Копировать
Редактировать
{
  "message": "user zaregistrirovan"
}
Логин пользователя
POST /auth/login

Параметры:

username (строка): имя пользователя

password (строка): пароль пользователя

Пример запроса:

json
Копировать
Редактировать
{
  "username": "john_doe",
  "password": "123456"
}
Ответ:

json
Копировать
Редактировать
{
  "token": "your-jwt-token"
}
Получение списка пользователей (только для администратора)
GET /auth/users

Необходима авторизация с ролью ADMIN. Запрос должен содержать JWT в заголовке Authorization.

Ответ:

json
Копировать
Редактировать
[
  {
    "id": "1",
    "username": "john_doe",
    "roles": ["USER"]
  },
  {
    "id": "2",
    "username": "admin",
    "roles": ["ADMIN"]
  }
]
Middleware
authMiddleware.js
Этот middleware проверяет наличие и действительность JWT в заголовке запроса. Если токен отсутствует или недействителен, возвращается ошибка 403.

roleMiddleware.js
Этот middleware проверяет, имеет ли пользователь достаточные права для доступа к маршруту. Он принимает список разрешенных ролей и проверяет, есть ли у пользователя хотя бы одна из этих ролей.

Технологии
Node.js

Express.js

MongoDB (через Mongoose)

JWT (JSON Web Token)

bcryptjs для хеширования паролей

express-validator для валидации данных

dotenv для загрузки переменных окружения